import Fehlerbox from"./Fehlerbox.min.js";import liqui_planner from"./../liqui-planner.min.js";export default class Eingabeformular{constructor(){this._html=this._html_generieren()}_formulardaten_holen(e){return{titel:e.target.elements.titel.value,betrag:e.target.elements.betrag.value,einnahme:e.target.elements.einnahme.checked,datum:e.target.elements.datum.valueAsDate}}_formulardaten_verarbeiten(e){return{titel:e.titel.trim(),typ:!1===e.einnahme?"ausgabe":"einnahme",betrag:100*parseFloat(e.betrag),datum:e.datum}}_formulardaten_validieren(e){let t=[];return""===e.titel&&t.push("Titel"),isNaN(e.betrag)&&t.push("Betrag"),null===e.datum&&t.push("Datum"),t}_datum_aktualisieren(){let e=document.querySelector("#datum");null!==e&&(e.valueAsDate=new Date)}_absenden_event_hinzufuegen(e){e.querySelector("#eingabeformular").addEventListener("submit",e=>{e.preventDefault();let t=this._formulardaten_verarbeiten(this._formulardaten_holen(e)),a=this._formulardaten_validieren(t);if(0===a.length){liqui_planner.eintrag_hinzufuegen(t);let a=document.querySelector(".fehlerbox");null!==a&&a.remove(),e.target.reset(),this._datum_aktualisieren()}else{new Fehlerbox("Folgende Felder wurden nicht korrekt ausgefüllt:",a).anzeigen()}})}_html_generieren(){let e=document.createElement("section");return e.setAttribute("id","eingabeformular-container"),e.innerHTML='<form id="eingabeformular" action="#" method="get"></form>\n        <div class="eingabeformular-zeile">\n            <h1>Neue Einnahme / Ausgabe hinzufügen</h1>\n        </div>\n        <div class="eingabeformular-zeile">\n            <div class="titel-typ-eingabe-gruppe">\n                <label for="titel">Titel</label>\n                <input type="text" id="titel" form="eingabeformular" name="titel" placeholder="z.B. Einkaufen" size="10" title="Titel des Eintrags">\n                <input type="radio" id="einnahme" name="typ" value="einnahme" form="eingabeformular" title="Typ des Eintrags">\n                <label for="einnahme" title="Typ des Eintrags">Einnahme</label>\n                <input type="radio" id="ausgabe" name="typ" value="ausgabe" form="eingabeformular" title="Typ des Eintrags" checked>\n                <label for="ausgabe" title="Typ des Eintrags">Ausgabe</label>\n            </div>\n        </div>\n        <div class="eingabeformular-zeile">\n            <div class="betrag-datum-eingabe-gruppe">\n                <label for="betrag">Betrag</label>\n                <input type="number" id="betrag" name="betrag" form="eingabeformular" placeholder="z.B. 10,42" size="10" step="0.01" min="0.01" title="Betrag des Eintrags (max. zwei Nachkommastellen, kein €-Zeichen)">\n                <label for="datum">Datum</label>\n                <input type="date" id="datum" name="datum" form="eingabeformular" size="10" title="Datum des Eintrags">\n            </div>\n        </div>\n        <div class="eingabeformular-zeile">\n            <button class="standard" type="submit" form="eingabeformular">Hinzufügen</button>\n        </div>',this._absenden_event_hinzufuegen(e),e}anzeigen(){let e=document.querySelector("#navigationsleiste");null!==e&&(e.insertAdjacentElement("afterend",this._html),this._datum_aktualisieren())}}